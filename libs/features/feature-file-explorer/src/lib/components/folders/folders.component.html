<section id="folder-adress">
  <div class="header">
    <span>Folders</span> <i class="fa-solid fa-x" folderSectionAction></i>
  </div>

  <div class="available-folders">
    <div
      class="folders"
      showHideFolder
      [folderContent]="folderContent"
      title="Desktop"
      [class.selected]="id === 0"
    >
      <div class="children-toggle" #folderToggle>
        <i class="fa-solid fa-plus"></i>
      </div>
      <div class="folder-title" (dblclick)="openDesktopFolder()">
        <img
          src="/assets/images/windows-basic-folder.png"
          alt="Ícone de pasta"
        />
        <span>Desktop</span>
      </div>
    </div>

    <ul #folderContent>
      @for (program of allFolders$$ | async; track $index) {
        <ng-container
          [ngTemplateOutlet]="folder_node"
          [ngTemplateOutletContext]="{ $implicit: program }"
        ></ng-container>
      }
    </ul>
  </div>
</section>

<ng-template #folder_node let-program>
  <li
    showHideFolder
    [title]="program.title"
    [class.no-children]="!program.children || program.children.length <= 0"
  >
    <div class="folders" [class.selected]="id === program.id">
      @if (program.children && program.children.length > 0) {
        <div class="children-toggle" #folderToggle>
          <i class="fa-solid fa-plus"></i>
        </div>
      }
      <div class="folder-title" (dblclick)="openFolder(program)">
        <img
          src="/assets/images/windows-basic-folder.png"
          alt="Ícone de pasta"
        />
        <span> {{ program.title }}</span>
      </div>
    </div>

    @if (program.children && program.children.length > 0) {
      <div class="folder-content" #folderContent>
        <ul>
          @for (childProgram of program.children; track $index) {
            <ng-container
              [ngTemplateOutlet]="folder_node"
              [ngTemplateOutletContext]="{ $implicit: childProgram }"
            ></ng-container>
          }
        </ul>
      </div>
    }
  </li>
</ng-template>
